<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Superh√©roes Estoicos: Aventura Interactiva</title>
    <!-- 1. Cargar Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <!-- 2. Cargar la fuente Inter --><link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <style>
        /* 3. Definir la fuente para todo el cuerpo */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f9ff; /* bg-blue-50 */
            color: #1f2937; /* text-gray-800 */
        }
        
        /* 4. Estilos para el juego de Arrastrar y Soltar (Drag and Drop) */
        
        /* Estilo para el objeto que est√°s arrastrando */
        .dragging {
            opacity: 0.5;
            transform: scale(1.05);
            background-color: #fef08a; /* bg-yellow-200 */
            cursor: grabbing;
        }

        /* Estilo para el objeto que puedes arrastrar */
        .draggable {
            cursor: grab;
            transition: all 0.2s ease;
        }
        
        /* Estilo para la zona donde puedes soltar, cuando pasas por encima */
        .drag-over {
            border-style: dashed;
            border-color: #0ea5e9; /* border-sky-500 */
            background-color: #f0f9ff; /* bg-blue-50 */
        }

        /* 5. Estilos para el Acorde√≥n */
        .accordion-button {
            transition: background-color 0.2s ease;
        }

        /* Estilo para el bot√≥n cuando el acorde√≥n est√° activo/abierto */
        .accordion-button.active {
            background-color: #bfdbfe; /* bg-blue-200 */
            color: #1d4ed8; /* text-blue-700 */
        }

        /* Peque√±a animaci√≥n para el contenido del acorde√≥n */
        .accordion-content {
            transition: max-height 0.3s ease-out, padding 0.3s ease;
            overflow: hidden;
            max-height: 0;
            padding-top: 0;
            padding-bottom: 0;
        }
        
        .accordion-content:not(.hidden) {
            max-height: 500px; /* Altura suficiente para el contenido */
            padding-top: 1rem; /* p-4 */
            padding-bottom: 1rem; /* p-4 */
        }

        /* 6. Estilos para la comprobaci√≥n del juego */
        .item-correct {
            border: 3px solid #22c55e !important; /* border-green-500 */
            background-color: #f0fdf4 !important; /* bg-green-50 */
        }
        .item-incorrect {
            border: 3px solid #ef4444 !important; /* border-red-500 */
            background-color: #fef2f2 !important; /* bg-red-50 */
        }
        /* Estilo para las im√°genes de virtud */
        .virtue-icon {
            width: 288px; /* 6 veces el tama√±o original de 48px, o el doble de 144px */
            height: 288px; /* Mantener la proporci√≥n para que sea cuadrada */
            margin: 0 auto; /* Centrar la imagen */
            object-fit: contain; /* Asegura que la imagen completa se vea dentro de su espacio */
        }
        /* Hacer la secci√≥n de botones cuadrada y que las im√°genes se adapten */
        #virtue-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            width: 100%;
            padding-bottom: 100%; /* Truco para hacer el contenedor cuadrado */
            position: relative; /* Necesario para el truco de padding-bottom */
            height: 0; /* Necesario para el truco de padding-bottom */
            align-items: stretch; /* Estirar los items para que ocupen todo el espacio */
        }
        #virtue-buttons .virtue-button {
            position: absolute; /* Posicionamiento absoluto dentro del contenedor cuadrado */
            width: calc(50% - 0.5rem); /* Ancho para dos columnas con gap */
            height: calc(50% - 0.5rem); /* Altura para dos filas con gap */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 0; /* Quitar padding interno para maximizar imagen */
            transition: all 0.2s ease;
            overflow: hidden; /* Evitar que la imagen se salga del bot√≥n */
        }
        #virtue-buttons .virtue-button:nth-child(1) { top: 0; left: 0; }
        #virtue-buttons .virtue-button:nth-child(2) { top: 0; right: 0; }
        #virtue-buttons .virtue-button:nth-child(3) { bottom: 0; left: 0; }
        #virtue-buttons .virtue-button:nth-child(4) { bottom: 0; right: 0; }
        /* Ajustes para el logo en el header */
        .header-content {
            display: flex;
            align-items: center;
            justify-content: center; /* Centrar el contenido principal del header */
            position: relative; /* Para posicionar el logo absolutamente */
            max-width: 900px; /* Ancho m√°ximo para el contenido del header */
            margin: 0 auto;
        }
        .header-logo {
            position: absolute;
            left: -100px; /* Ajusta este valor para mover m√°s a la izquierda, puedes experimentar */
            height: 180px; /* Logo 3 veces m√°s grande (original 60px * 3 = 180px) */
            width: auto; /* Mantener la proporci√≥n */
            top: 50%; /* Centrar verticalmente */
            transform: translateY(-50%); /* Ajuste fino para centrar */
        }
        /* Ajustar el padding izquierdo del contenedor de texto para evitar solapamiento */
        .header-text-container {
            padding-left: 100px; /* Ajusta esto seg√∫n el tama√±o del logo y su posici√≥n */
        }
        /* Reducir el tama√±o de las letras del encabezado */
        .header-content h1 {
            font-size: 3rem; /* Equivalente a text-4xl de Tailwind, ajustado */
        }
        .header-content p {
            font-size: 1.25rem; /* Equivalente a text-xl de Tailwind, ajustado */
        }

        /* Estilos para el Modal de Recompensa */
        .modal {
            position: fixed;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            text-align: center;
            max-width: 90%;
            width: 500px;
            position: relative;
        }
        .modal-close-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6b7280; /* text-gray-500 */
        }
         #reward-video {
            width: 100%;
            max-height: 70vh; /* Limitar altura del video */
            border-radius: 0.5rem;
        }


        @media (max-width: 768px) {
            .header-logo {
                height: 80px; /* M√°s grande que antes en m√≥viles (original 40px * 2 = 80px) */
                left: 1rem; /* Margen en m√≥viles */
                position: relative; /* Cambiar a relativo para flujo normal en m√≥viles */
                transform: none; /* Quitar transformaci√≥n vertical en m√≥viles */
                margin-bottom: 1rem; /* A√±adir espacio debajo del logo */
            }
            .header-content {
                flex-direction: column; /* Apilar en m√≥viles */
                text-align: center;
                padding-left: 0; /* Quitar padding izquierdo en m√≥viles */
            }
            .header-text-container {
                padding-left: 0; /* Quitar padding izquierdo en m√≥viles */
            }
            .header-content h1 {
                font-size: 2.5rem; /* Ajustar para m√≥viles */
            }
            .header-content p {
                font-size: 1rem; /* Ajustar para m√≥viles */
            }
            /* Ajustes para m√≥viles en la secci√≥n de virtudes */
            #virtue-buttons {
                padding-bottom: 0; /* Desactivar truco cuadrado en m√≥viles para mejor flujo */
                height: auto; /* Permitir altura autom√°tica */
                position: relative; /* Mantener relativo para posicionamiento de hijos */
                grid-template-columns: 1fr; /* Una columna en m√≥viles */
                gap: 1rem;
            }
            #virtue-buttons .virtue-button {
                position: relative; /* Restaurar posicionamiento relativo */
                width: 100%; /* Ocupar todo el ancho */
                height: auto; /* Altura autom√°tica */
                top: auto; left: auto; right: auto; bottom: auto; /* Eliminar posiciones fijas */
                padding: 1rem; /* Restaurar padding para un mejor toque en m√≥viles */
            }
            .virtue-icon {
                width: 96px; /* Ajuste para m√≥viles, 2 veces el original */
                height: 96px;
            }
        }
    </style>
</head>
<body class="bg-blue-50">

    <!-- Encabezado Heroico --><header class="bg-gradient-to-r from-blue-600 to-cyan-500 text-white p-8 md:p-12 text-center shadow-lg rounded-b-3xl relative overflow-hidden">
        <div class="header-content">
            <img src="https://github.com/GuillermoOseguera/Estoico/blob/main/logo.png?raw=true" alt="Logo Estoico" class="header-logo">
            <div class="header-text-container">
                <h1 class="font-black mb-4">¬°Convi√©rtete en un Superh√©roe de la Mente! ü¶∏‚Äç‚ôÇÔ∏èüß†</h1>
                <p class="font-light max-w-3xl mx-auto">Elias: Descubre los secretos de los Estoicos: sabios antiguos que eran como superh√©roes de la vida real.</p>
            </div>
        </div>
    </header>

    <!-- Contenedor Principal --><main class="max-w-6xl mx-auto p-4 md:p-8 space-y-12 md:space-y-16">

        <!-- Secci√≥n 1: ¬øQui√©nes eran los Estoicos? --><section class="bg-white rounded-2xl shadow-lg p-6 md:p-8 transform transition hover:scale-[1.02] duration-300">
            <h2 class="text-3xl font-bold text-blue-700 mb-4">Los Sabios Antiguos üèõÔ∏è</h2>
            <p class="text-lg leading-relaxed">
                "Hace much√≠simo tiempo, en la antigua Grecia, hab√≠a un grupo de personas muy inteligentes que se hac√≠an preguntas importantes: ¬øC√≥mo puedo ser feliz? ¬øC√≥mo puedo ser valiente cuando tengo miedo? ¬øQu√© puedo hacer cuando algo malo me pasa?
            </p>
            <p class="text-lg leading-relaxed mt-4">
                Estos pensadores se llamaban <strong>Estoicos</strong>, y descubrieron secretos incre√≠bles sobre c√≥mo vivir bien. ¬°Y lo mejor es que estos secretos funcionan igual de bien hoy que hace miles de a√±os!"
            </p>
        </section>

        <!-- Secci√≥n 2: Juego Interactivo "Las Dos Cajas" --><section class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
            <h2 class="text-3xl font-bold text-center text-blue-700 mb-2">Tu Primer Superpoder: La Regla de las Dos Cajas ‚ö°</h2>
            <p class="text-lg text-center mb-6">¬°Vamos a jugar! Arrastra cada situaci√≥n a la caja correcta.</p>
            <p class="text-center mb-6 font-semibold">La regla de oro: ¬°Solo enf√≥cate en lo que est√° en la caja verde! Lo de la caja roja, d√©jalo ir.</p>
            <p id="streak-counter" class="text-center text-lg font-bold text-purple-700 mb-4">Racha de aciertos perfectos: 0</p>
            
            <div class="flex flex-col md:flex-row gap-6">
                <!-- Columna de Preocupaciones --><div class="w-full md:w-1/3">
                    <h3 class="text-xl font-bold text-center mb-4 p-3 bg-gray-200 rounded-lg">Arrastra estas 7 situaciones üëá</h3>
                    <div id="worries-list" class="space-y-3 p-4 bg-gray-50 rounded-lg min-h-[450px]">
                        <!-- Los 7 elementos aleatorios se insertar√°n aqu√≠ --></div>
                    <!-- Botones de Acci√≥n --><div class="mt-4 space-y-3">
                        <button id="check-button" class="w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg shadow hover:bg-green-700 transition duration-200">
                            ¬°Comprobar Respuestas!
                        </button>
                        <button id="reset-button" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg shadow hover:bg-blue-700 transition duration-200">
                            ¬°Reiniciar Juego!
                        </button>
                        <!-- √Årea de Resultados --><div id="results-area" class="hidden text-center text-xl font-bold p-3 bg-yellow-100 border border-yellow-300 rounded-lg">
                            <!-- El resultado se insertar√° aqu√≠ --></div>
                    </div>
                </div>

                <!-- Columna de Cajas (Zonas de Soltar) --><div class="w-full md:w-2/3 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Caja Verde --><div class="bg-green-100 rounded-lg border-4 border-green-500 shadow-inner">
                        <h3 class="text-xl font-bold text-center p-4 bg-green-500 text-white rounded-t-md">‚úÖ PUEDO CONTROLARLO ‚úÖ</h3>
                        <div id="box-green" class="drop-zone min-h-[300px] p-4 space-y-3">
                            <!-- Aqu√≠ caen las cosas --></div>
                    </div>
                    <!-- Caja Roja --><div class="bg-red-100 rounded-lg border-4 border-red-500 shadow-inner">
                        <h3 class="text-xl font-bold text-center p-4 bg-red-500 text-white rounded-t-md">‚ùå NO PUEDO CONTROLARLO ‚ùå</h3>
                        <div id="box-red" class="drop-zone min-h-[300px] p-4 space-y-3">
                            <!-- Aqu√≠ caen las cosas --></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Secci√≥n 3: El Desaf√≠o de las 4 Virtudes --><section class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
            <h2 class="text-3xl font-bold text-center text-blue-700 mb-6">Secci√≥n 3: El Desaf√≠o de las 4 Virtudes ‚öîÔ∏è</h2>
            <p class="text-lg text-center mb-8">¬°Hora del desaf√≠o, El√≠as! Te enfrentar√°s a situaciones reales. Elige el "superpoder" (la virtud) que mejor te ayudar√≠a a manejarla.</p>
            
            <div id="virtue-quiz" class="max-w-3xl mx-auto bg-gray-50 p-6 rounded-lg shadow-inner">
                <!-- Escenario --><div class="mb-6 min-h-[100px]">
                    <p id="scenario-text" class="text-xl text-center font-medium text-gray-800">Cargando desaf√≠o...</p>
                </div>

                <!-- Botones de Virtud --><div id="virtue-buttons" class="gap-4 mb-6">
                    <button data-virtue="sabiduria" class="virtue-button bg-yellow-400 hover:bg-yellow-500 text-yellow-900 p-4 rounded-lg shadow transition duration-200 transform hover:scale-105">
                        <img src="https://github.com/GuillermoOseguera/Estoico/blob/main/Sabiduria.png?raw=true" alt="B√∫ho de Sabidur√≠a" class="virtue-icon">
                        <!-- <span class="block text-xl font-bold">Sabidur√≠a</span> --></button>
                    <button data-virtue="coraje" class="virtue-button bg-red-400 hover:bg-red-500 text-red-900 p-4 rounded-lg shadow transition duration-200 transform hover:scale-105">
                        <img src="https://github.com/GuillermoOseguera/Estoico/blob/main/Coraje.png?raw=true" alt="Le√≥n de Coraje" class="virtue-icon">
                        <!-- <span class="block text-xl font-bold">Coraje</span> --></button>
                    <button data-virtue="justicia" class="virtue-button bg-blue-400 hover:bg-blue-500 text-blue-900 p-4 rounded-lg shadow transition duration-200 transform hover:scale-105">
                        <img src="https://github.com/GuillermoOseguera/Estoico/blob/main/Justicia.png?raw=true" alt="Balanza de Justicia" class="virtue-icon">
                        <!-- <span class="block text-xl font-bold">Justicia</span> --></button>
                    <button data-virtue="templanza" class="virtue-button bg-green-400 hover:bg-green-500 text-green-900 p-4 rounded-lg shadow transition duration-200 transform hover:scale-105">
                        <img src="https://github.com/GuillermoOseguera/Estoico/blob/main/Templanza.png?raw=true" alt="Persona Meditando de Templanza" class="virtue-icon">
                        <!-- <span class="block text-xl font-bold">Templanza</span> --></button>
                </div>

                <!-- Feedback --><div id="virtue-feedback" class="min-h-[100px] p-4 rounded-lg text-center text-lg font-medium hidden">
                    <!-- El feedback ir√° aqu√≠ --></div>

                <!-- Bot√≥n de Siguiente --><button id="next-challenge-button" class="w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg shadow hover:bg-indigo-700 transition duration-200 hidden mt-4">
                    Siguiente Desaf√≠o
                </button>
            </div>
        </section>

        <!-- Secci√≥n 4: Historias de H√©roes Legendarios --><section>
            <h2 class="text-3xl font-bold text-center text-blue-700 mb-4">Secci√≥n 4: Historias de H√©roes Legendarios ‚ú®</h2>
            
            <!-- Selector de Historias --><div class="max-w-md mx-auto mb-8">
                <label for="story-selector" class="block text-lg font-medium text-center text-gray-700 mb-2">Elige una historia para leer:</label>
                <select id="story-selector" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <!-- Las opciones se cargar√°n con JavaScript --></select>
            </div>

            <!-- Contenedor de la Historia (Imagen + Texto) --><div class="bg-white rounded-2xl shadow-lg p-6 md:p-8 flex flex-col md:flex-row gap-8 items-center">
                <!-- Columna de la Imagen (EST√ÅTICA) --><div class="w-full md:w-1/2 flex-shrink-0">
                    <img src="https://github.com/GuillermoOseguera/Estoico/blob/main/cuentos.png?raw=true" alt="Ilustraci√≥n de cuentos y aventuras" class="w-full h-auto rounded-lg shadow-md object-cover">
                </div>
                <!-- Columna del Texto (DIN√ÅMICA) --><div id="story-content-wrapper" class="w-full md:w-1/2 flex flex-col min-h-[300px]">
                    <!-- El contenido de la historia (t√≠tulo, p√°rrafos, lecci√≥n) se cargar√° aqu√≠ --></div>
            </div>
        </section>

        <!-- Secci√≥n 5: Entrenamiento --><section class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
            <h2 class="text-3xl font-bold text-center text-blue-700 mb-6">Secci√≥n 5: ¬°Comienza tu Entrenamiento de H√©roe! üéØ</h2>
            <p class="text-lg text-center mb-6">¬°Elias, lleg√≥ la hora de tu entrenamiento! Un superh√©roe de la mente practica todos los d√≠as. ¬°Haz clic en estas misiones para ver tus desaf√≠os!</p>
            <div id="accordion" class="space-y-4">
                <!-- Misi√≥n 1: Diario --><div>
                    <button class="accordion-button w-full text-left text-xl font-bold p-5 bg-blue-100 rounded-lg shadow hover:bg-blue-200 focus:outline-none flex justify-between items-center">
                        <span>Misi√≥n 1: El Diario del H√©roe (5 min) üìì</span>
                        <span class="arrow text-2xl font-bold">+</span>
                    </button>
                    <div class="accordion-content hidden bg-gray-50 p-4 rounded-b-lg border border-t-0 border-gray-200">
                        <p>Cada noche, responde estas tres preguntas en un cuaderno:</p>
                        <ul class="list-disc list-inside ml-4 mt-2 space-y-1">
                            <li>¬øQu√© hice bien hoy? (¬°Celebra tus victorias!)</li>
                            <li>¬øQu√© podr√≠a hacer mejor ma√±ana? (¬°Siempre aprendiendo!)</li>
                            <li>¬øPor qu√© cosa estoy agradecido? (¬°Encuentra lo bueno!)</li>
                        </ul>
                    </div>
                </div>
                <!-- Misi√≥n 2: Juego Y Qu√© Si --><div>
                    <button class="accordion-button w-full text-left text-xl font-bold p-5 bg-blue-100 rounded-lg shadow hover:bg-blue-200 focus:outline-none flex justify-between items-center">
                        <span>Misi√≥n 2: El Juego de "¬øY Qu√© Si?" ü§î</span>
                        <span class="arrow text-2xl font-bold">+</span>
                    </button>
                    <div class="accordion-content hidden bg-gray-50 p-4 rounded-b-lg border border-t-0 border-gray-200">
                        <p>Cuando algo te preocupa, juega este juego en tu mente:</p>
                        <ul class="list-none mt-2 space-y-1">
                            <li><strong>T√∫:</strong> "Me preocupa reprobar el examen."</li>
                            <li><strong>Preg√∫ntate:</strong> "<em>¬øY qu√© si repruebo?</em>"</li>
                            <li><strong>T√∫:</strong> "Estudiar√© m√°s la pr√≥xima vez."</li>
                            <li><strong>Preg√∫ntate:</strong> "<em>¬øEso ser√≠a el fin del mundo?</em>"</li>
                            <li><strong>T√∫:</strong> "No, solo tendr√≠a que esforzarme m√°s."</li>
                        </ul>
                        <p class="mt-2 font-medium">¬°Ver√°s que la mayor√≠a de tus preocupaciones no son tan terribles como parecen!</p>
                    </div>
                </div>
                <!-- Misi√≥n 3: Bondad Secreta --><div>
                    <button class="accordion-button w-full text-left text-xl font-bold p-5 bg-blue-100 rounded-lg shadow hover:bg-blue-200 focus:outline-none flex justify-between items-center">
                        <span>Misi√≥n 3: La Misi√≥n Secreta de Bondad ü§´</span>
                        <span class="arrow text-2xl font-bold">+</span>
                    </button>
                    <div class="accordion-content hidden bg-gray-50 p-4 rounded-b-lg border border-t-0 border-gray-200">
                        <p>Tu misi√≥n: cada d√≠a, haz algo bueno por alguien <strong>sin que nadie se entere</strong>. Puede ser:</p>
                        <ul class="list-disc list-inside ml-4 mt-2 space-y-1">
                            <li>Ayudar a un compa√±ero con su tarea.</li>
                            <li>Recoger algo que se le cay√≥ a alguien.</li>
                            <li>Decir algo amable.</li>
                            <li>¬°Compartir tu merienda!</li>
                        </ul>
                        <p class="mt-2 font-medium">¬øPuedes hacerlo sin decirle a nadie? ¬°Ese es el verdadero desaf√≠o de un h√©roe!</p>
                    </div>
                </div>
                <!-- Misi√≥n 4: Entrenamiento de Paciencia --><div>
                    <button class="accordion-button w-full text-left text-xl font-bold p-5 bg-blue-100 rounded-lg shadow hover:bg-blue-200 focus:outline-none flex justify-between items-center">
                        <span>Misi√≥n 4: Entrenamiento de Paciencia ‚è≥</span>
                        <span class="arrow text-2xl font-bold">+</span>
                    </button>
                    <div class="accordion-content hidden bg-gray-50 p-4 rounded-b-lg border border-t-0 border-gray-200">
                        <p>¬°Los estoicos practicaban el autocontrol! Prueba estos mini-desaf√≠os:</p>
                        <ul class="list-disc list-inside ml-4 mt-2 space-y-1">
                            <li>Espera 5 minutos antes de pedir un dulce.</li>
                            <li>Cuenta hasta 10 cuando est√©s enojado antes de reaccionar.</li>
                            <li>Termina tu tarea antes de jugar, aunque no quieras.</li>
                            <li>Escucha completamente a alguien sin interrumpir.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Secci√≥n 6: Actividad Final --><section class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
            <h2 class="text-3xl font-bold text-center text-blue-700 mb-6">Secci√≥n 6: ¬°Dise√±a tu Escudo Estoico! üõ°Ô∏è</h2>
            <p class="text-lg text-center mb-4">
                El√≠as, un verdadero h√©roe necesita su propio escudo. ¬°Aqu√≠ te dejamos un ejemplo para que te inspires al crear el tuyo! 
                Recuerda que tu escudo representar√° los "superpoderes" que los estoicos nos ense√±an.
            </p>
            <div class="flex justify-center mb-6">
                <img src="https://github.com/GuillermoOseguera/Estoico/blob/main/escudo%20estoico.png?raw=true" alt="Ejemplo de Escudo Estoico" class="max-w-full h-auto rounded-lg shadow-md border-2 border-gray-300">
            </div>
            <p class="text-lg text-center mt-6">
                ¬°Ahora es tu turno! Dibuja tu propio escudo dividido en cuatro partes, y en cada una, dibuja o escribe un s√≠mbolo
                para la Sabidur√≠a (como un b√∫ho), el Coraje (como un le√≥n), la Justicia (como una balanza) y la Templanza (como una persona meditando).
                ¬°Este ser√° tu escudo de h√©roe estoico, listo para recordarte tus poderes cuando enfrentes cualquier desaf√≠o!
            </p>
        </section>

        <!-- Resumen Final --><footer class="bg-gradient-to-r from-blue-700 to-cyan-600 text-white p-8 md:p-12 text-center shadow-lg rounded-2xl">
            <h2 class="text-3xl font-black mb-4">Resumen de H√©roe üåü</h2>
            <p id="footer-quote" class="text-xl font-light mb-4">Cargando frase de h√©roe...</p>
            <p class="text-lg font-semibold">Recuerda: ¬°No puedes controlar lo que pasa, pero S√ç puedes controlar c√≥mo reaccionas!</p>
        </footer>

    </main>

    <!-- Modal de Recompensa (Oculto por defecto) --><div id="reward-modal" class="modal">
        <div class="modal-content">
            <button id="close-modal-button" class="modal-close-button">&times;</button>
            <div id="reward-message-container">
                 <h3 class="text-2xl font-bold text-green-600 mb-4">¬°Felicidades, H√©roe! üéâ</h3>
                <p class="text-lg mb-6">Genial, tuviste 7 aciertos 3 veces seguidas, eso se merece un premio. Da click en el bot√≥n para obtener tu recompensa.</p>
                <button id="reward-button" class="bg-purple-600 text-white font-bold py-3 px-6 rounded-lg shadow hover:bg-purple-700 transition duration-200">
                    ¬°Ver Recompensa!
                </button>
            </div>
            <div id="reward-video-container" class="hidden mt-4">
                 <video id="reward-video" controls>
                    <source src="https://raw.githubusercontent.com/GuillermoOseguera/Estoico/main/videoelias.mp4" type="video/mp4">
                    Tu navegador no soporta el video MP4.
                </video>
            </div>
        </div>
    </div>

    <!-- Script para Confeti (Fuente: https://www.jsdelivr.com/package/npm/canvas-confetti) --><script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

    <script>
        // --- L√ìGICA GENERAL ---
        document.addEventListener('DOMContentLoaded', () => {
            // --- L√ìGICA PARA EL ACORDE√ìN ---
            const accordionButtons = document.querySelectorAll('.accordion-button');
            accordionButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const content = button.nextElementSibling;
                    const arrow = button.querySelector('.arrow');
                    content.classList.toggle('hidden');
                    if (content.classList.contains('hidden')) {
                        button.classList.remove('active');
                        arrow.textContent = '+';
                    } else {
                        button.classList.add('active');
                        arrow.textContent = '‚àí';
                    }
                });
            });

            // --- L√ìGICA PARA ARRASTRAR Y SOLTAR (DRAG & DROP) ---
            const allWorries = [/* ... (m√°s de 100 preocupaciones como antes) ... */
                // Contexto: General (14 a√±os)
                { text: "Mi reacci√≥n si saco una mala nota", correctBox: "green" }, { text: "El tema que vendr√° en el examen", correctBox: "red" }, { text: "Cu√°ntas horas estudio para el examen", correctBox: "green" }, { text: "Lo que mis amigos piensan de mi ropa", correctBox: "red" }, { text: "Ser honesto con mis padres", correctBox: "green" }, { text: "Que me inviten a una fiesta", correctBox: "red" }, { text: "Pedir ayuda en una materia que me cuesta", correctBox: "green" }, { text: "Lo que otros postean en redes sociales", correctBox: "red" }, { text: "Lo que *yo* decido postear en redes", correctBox: "green" }, { text: "Acostarme a una hora razonable", correctBox: "green" }, { text: "Tener m√°s talento natural que otros", correctBox: "red" }, { text: "Mi esfuerzo en practicar algo", correctBox: "green" }, { text: "Si la pel√≠cula que quiero ver es buena", correctBox: "red" }, { text: "Elegir qu√© ropa ponerme hoy", correctBox: "green" }, { text: "El tr√°fico en el camino a la escuela", correctBox: "red" }, { text: "Mi actitud ante el tr√°fico", correctBox: "green" }, { text: "Que mis compa√±eros me hagan re√≠r en clase", correctBox: "red" }, { text: "Mi decisi√≥n de prestar atenci√≥n en clase", correctBox: "green" }, { text: "La popularidad de un influencer", correctBox: "red" }, { text: "La limpieza de mi habitaci√≥n", correctBox: "green" }, { text: "El clima de hoy", correctBox: "red" }, { text: "Prepararme para un d√≠a lluvioso", correctBox: "green" }, { text: "Que me regalen algo que no me gusta", correctBox: "red" }, { text: "Agradecer por un regalo, aunque no me guste", correctBox: "green" }, { text: "El precio de mi juego favorito", correctBox: "red" }, { text: "Ahorrar para comprar un juego", correctBox: "green" }, { text: "Las opiniones pol√≠ticas de otras personas", correctBox: "red" }, { text: "Formarme mi propia opini√≥n", correctBox: "green" }, { text: "Que alguien me hable mal", correctBox: "red" }, { text: "C√≥mo respondo a alguien que me habla mal", correctBox: "green" }, { text: "Mi nivel de energ√≠a por la ma√±ana", correctBox: "red" }, { text: "Decidir si desayuno bien o no", correctBox: "green" }, { text: "La cantidad de tarea que me dejan", correctBox: "red" }, { text: "Hacer la tarea con esfuerzo y a tiempo", correctBox: "green" }, { text: "El ruido de mis vecinos", correctBox: "red" }, { text: "Buscar un lugar tranquilo para estudiar", correctBox: "green" }, { text: "Si un video se hace viral", correctBox: "red" }, { text: "La calidad de los videos que hago", correctBox: "green" }, { text: "Que me critiquen en un juego online", correctBox: "red" }, { text: "Mi reacci√≥n a una cr√≠tica en un juego", correctBox: "green" }, { text: "Mi estado de √°nimo general", correctBox: "red" }, { text: "Hacer actividades que mejoren mi √°nimo", correctBox: "green" }, { text: "Si mi banda favorita se separa", correctBox: "red" }, { text: "Disfrutar la m√∫sica que ya existe", correctBox: "green" }, { text: "La calidad de la comida en la cafeter√≠a", correctBox: "red" }, { text: "Elegir opciones saludables en la cafeter√≠a", correctBox: "green" }, { text: "Que me toque el asiento de al lado de alguien ruidoso", correctBox: "red" }, { text: "Mi concentraci√≥n a pesar del ruido", correctBox: "green" }, { text: "Las decisiones del director de la escuela", correctBox: "red" }, { text: "Seguir las reglas de la escuela", correctBox: "green" },
                // Contexto: Futbol
                { text: "Mi actitud si pierdo el partido de futbol", correctBox: "green" }, { text: "Que el entrenador me ponga de titular", correctBox: "red" }, { text: "El resultado final del partido", correctBox: "red" }, { text: "El esfuerzo que pongo en el entrenamiento", correctBox: "green" }, { text: "Felicitar al otro equipo si nos ganan", correctBox: "green" }, { text: "Que llueva el d√≠a del partido", correctBox: "red" }, { text: "El talento de los jugadores del otro equipo", correctBox: "red" }, { text: "El tiempo que dedico a practicar tiros libres", correctBox: "green" }, { text: "Las decisiones del √°rbitro", correctBox: "red" }, { text: "Mi respeto hacia el √°rbitro", correctBox: "green" }, { text: "El estado del campo de juego", correctBox: "red" }, { text: "Ajustar mi juego al estado del campo", correctBox: "green" }, { text: "Si mis compa√±eros meten goles", correctBox: "red" }, { text: "Animar a mis compa√±eros", correctBox: "green" }, { text: "El color del uniforme del equipo contrario", correctBox: "red" }, { text: "Mi concentraci√≥n en el juego", correctBox: "green" }, { text: "Una lesi√≥n inesperada de un compa√±ero", correctBox: "red" }, { text: "Ayudar a un compa√±ero lesionado", correctBox: "green" }, { text: "Las t√°cticas que el entrenador decida", correctBox: "red" }, { text: "Ejecutar las t√°cticas lo mejor posible", correctBox: "green" },
                // Contexto: Familia (Jari, Elisa, Paco, Estela)
                { text: "Ser paciente con mi hermana Elisa", correctBox: "green" }, { text: "Que Elisa me pida usar mi Switch", correctBox: "red" }, { text: "Mi reacci√≥n si Elisa me molesta", correctBox: "green" }, { text: "Ayudar a mi mam√° Jari en la casa", correctBox: "green" }, { text: "Que mi mam√° Jari est√© de mal humor", correctBox: "red" }, { text: "Cumplir con lo que le promet√≠ a mi mam√° Jari", correctBox: "green" }, { text: "Visitar a mi abuelo Paco", correctBox: "green" }, { text: "Lo que mi abuelo Paco opina de mi m√∫sica", correctBox: "red" }, { text: "Preguntarle a mi abuelo Paco sobre sus historias", correctBox: "green" }, { text: "Que mi mam√° (Jari) me d√© permiso para salir", correctBox: "red" }, { text: "Ayudar a mi abuela Estela con el jard√≠n", correctBox: "green" }, { text: "Lo que mi abuela Estela cocine hoy", correctBox: "red" }, { text: "Ser amable con mis primos", correctBox: "green" }, { text: "Que mis t√≠os visiten sin avisar", correctBox: "red" }, { text: "Mi actitud si tenemos visitas inesperadas", correctBox: "green" }, { text: "Recordar el cumplea√±os de un familiar", correctBox: "green" }, { text: "Si mi familia se muda lejos", correctBox: "red" }, { text: "Mantenerme en contacto con mi familia", correctBox: "green" }, { text: "Las discusiones entre mis padres", correctBox: "red" }, { text: "Mi comportamiento durante una discusi√≥n familiar", correctBox: "green" },
                // Contexto: Videojuegos (Sonic, Minecraft, Switch)
                { text: "Terminar mis tareas antes de jugar Minecraft", correctBox: "green" }, { text: "Que haya lag en la partida de Sonic", correctBox: "red" }, { text: "El tiempo que decido jugar Switch", correctBox: "green" }, { text: "Que un creeper explote mi casa en Minecraft", correctBox: "red" }, { text: "Mi reacci√≥n si un creeper lo explota todo", correctBox: "green" }, { text: "Ahorrar para comprar un nuevo juego de Switch", correctBox: "green" }, { text: "Un bug que arruina mi partida", correctBox: "red" }, { text: "Lo que opinan mis amigos de mi mundo en Minecraft", correctBox: "red" }, { text: "Que se vaya el internet mientras juego", correctBox: "red" }, { text: "Cuidar bien mi Nintendo Switch", correctBox: "green" }, { text: "El anuncio de un nuevo juego de Sonic", correctBox: "red" }, { text: "Mi comportamiento justo en un juego online", correctBox: "green" }, { text: "Que un tramposo gane en mi juego favorito", correctBox: "red" }, { text: "Reportar a un tramposo", correctBox: "green" }, { text: "La dificultad de un nivel de juego", correctBox: "red" }, { text: "Mi persistencia para pasar un nivel dif√≠cil", correctBox: "green" }, { text: "Los gr√°ficos de un juego viejo", correctBox: "red" }, { text: "Disfrutar la historia o la jugabilidad de un juego", correctBox: "green" }, { text: "Que mis amigos prefieran otro juego", correctBox: "red" }, { text: "Estar abierto a probar nuevos juegos", correctBox: "green" },
                // Contexto: Actividades (Nataci√≥n, Karate)
                { text: "Ir a nataci√≥n aunque est√© cansado", correctBox: "green" }, { text: "Ser el m√°s r√°pido de la alberca", correctBox: "red" }, { text: "Mi esfuerzo en la clase de nataci√≥n", correctBox: "green" }, { text: "Lo que opinaban mis amigos de que hac√≠a karate", correctBox: "red" }, { text: "Decidir si quiero probar karate otra vez", correctBox: "green" }, { text: "Aplicar la disciplina que aprend√≠ en karate", correctBox: "green" }, { text: "El estilo de nadar de mis compa√±eros", correctBox: "red" }, { text: "Mi concentraci√≥n en los ejercicios de karate", correctBox: "green" }, { text: "Si la clase de nataci√≥n se cancela", correctBox: "red" }, { text: "Buscar otra forma de hacer ejercicio si se cancela la clase", correctBox: "green" }, { text: "El tama√±o de los oponentes en karate", correctBox: "red" }, { text: "Mi t√©cnica en karate, no solo la fuerza", correctBox: "green" }, { text: "Ganar una medalla en nataci√≥n", correctBox: "red" }, { text: "Mejorar mi tiempo en nataci√≥n", correctBox: "green" }, { text: "El equipo de nataci√≥n que me toca", correctBox: "red" }, { text: "Ser un buen compa√±ero de equipo", correctBox: "green" }, { text: "Que mi instructor me corrija mucho", correctBox: "red" }, { text: "Aceptar las correcciones de mi instructor", correctBox: "green" }, { text: "El n√∫mero de cinturones que tengo en karate", correctBox: "red" }, { text: "Mi progreso en las katas de karate", correctBox: "green" }
            ];
            const dropZones = document.querySelectorAll('.drop-zone');
            const worriesList = document.getElementById('worries-list');
            const resetButton = document.getElementById('reset-button');
            const checkButton = document.getElementById('check-button');
            const resultsArea = document.getElementById('results-area');
            let draggables = [];
            let consecutivePerfectScores = 0;
            const streakCounterEl = document.getElementById('streak-counter');

            function shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            }

            function populateWorriesList() {
                worriesList.innerHTML = '';
                document.getElementById('box-green').innerHTML = '';
                document.getElementById('box-red').innerHTML = '';
                shuffleArray(allWorries);
                const randomWorries = allWorries.slice(0, 7);
                randomWorries.forEach((worry, index) => {
                    const div = document.createElement('div');
                    const id = `worry${index + 1}`;
                    div.id = id;
                    const class_base = "draggable bg-white p-4 rounded-lg shadow border border-gray-200 text-center font-medium";
                    div.setAttribute('class_base', class_base);
                    div.className = class_base;
                    div.setAttribute('draggable', 'true');
                    div.setAttribute('data-correct-box', worry.correctBox);
                    div.textContent = worry.text;
                    worriesList.appendChild(div);
                });
                resultsArea.textContent = '';
                resultsArea.classList.add('hidden');
                if (streakCounterEl) streakCounterEl.textContent = `Racha de aciertos perfectos: ${consecutivePerfectScores}`;
            }

            function setupDraggables() {
                draggables = document.querySelectorAll('[draggable="true"]');
                draggables.forEach(draggable => {
                    draggable.addEventListener('dragstart', (e) => {
                        draggable.classList.add('dragging');
                        e.dataTransfer.setData('text/plain', draggable.id);
                    });
                    draggable.addEventListener('dragend', () => {
                        draggable.classList.remove('dragging');
                    });
                });
            }

            dropZones.forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    zone.classList.add('drag-over');
                });
                zone.addEventListener('dragleave', () => {
                    zone.classList.remove('drag-over');
                });
                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    zone.classList.remove('drag-over');
                    const id = e.dataTransfer.getData('text/plain');
                    const draggableElement = document.getElementById(id);
                    if (draggableElement) {
                        zone.appendChild(draggableElement);
                        draggableElement.className = draggableElement.getAttribute('class_base');
                        resultsArea.classList.add('hidden');
                    }
                });
            });

            checkButton.addEventListener('click', () => {
                let correctCount = 0;
                const totalItems = draggables.length;
                let allPlaced = true;
                draggables.forEach(draggable => {
                    if (!draggable.parentElement || (draggable.parentElement.id !== 'box-green' && draggable.parentElement.id !== 'box-red')) {
                        allPlaced = false;
                    }
                    draggable.className = draggable.getAttribute('class_base');
                });

                if (!allPlaced) {
                    resultsArea.textContent = `¬°Debes colocar todas las situaciones en alguna caja!`;
                    resultsArea.classList.remove('hidden');
                    resultsArea.className = "text-center text-xl font-bold p-3 bg-red-100 border border-red-300 rounded-lg text-red-700";
                    consecutivePerfectScores = 0;
                    if (streakCounterEl) streakCounterEl.textContent = `Racha de aciertos perfectos: ${consecutivePerfectScores}`;
                    return;
                }

                draggables.forEach(draggable => {
                    const correctBox = draggable.getAttribute('data-correct-box');
                    const parentBox = draggable.parentElement;
                    let isCorrect = false;
                    if (correctBox === 'green' && parentBox.id === 'box-green') isCorrect = true;
                    else if (correctBox === 'red' && parentBox.id === 'box-red') isCorrect = true;

                    if (isCorrect) {
                        correctCount++;
                        draggable.classList.add('item-correct');
                    } else if (parentBox.id === 'box-green' || parentBox.id === 'box-red') {
                        draggable.classList.add('item-incorrect');
                    }
                });

                resultsArea.textContent = `¬°Acertaste ${correctCount} de ${totalItems}! ${correctCount === totalItems ? 'üéâ' : 'üëç'}`;
                resultsArea.className = "hidden text-center text-xl font-bold p-3 bg-yellow-100 border border-yellow-300 rounded-lg"; // Reset style
                resultsArea.classList.remove('hidden');

                if (correctCount === totalItems) {
                    consecutivePerfectScores++;
                    if (typeof confetti === 'function') {
                        confetti({ particleCount: 150, spread: 90, origin: { y: 0.6 } });
                    }
                    if (consecutivePerfectScores >= 3) {
                        showRewardModal();
                        consecutivePerfectScores = 0;
                    }
                } else {
                    consecutivePerfectScores = 0;
                }
                if (streakCounterEl) streakCounterEl.textContent = `Racha de aciertos perfectos: ${consecutivePerfectScores}`;
            });

            resetButton.addEventListener('click', () => {
                populateWorriesList();
                setupDraggables();
            });

            // --- L√ìGICA PARA EL MODAL DE RECOMPENSA ---
            const rewardModal = document.getElementById('reward-modal');
            const closeModalButton = document.getElementById('close-modal-button');
            const rewardButton = document.getElementById('reward-button');
            const rewardMessageContainer = document.getElementById('reward-message-container');
            const rewardVideoContainer = document.getElementById('reward-video-container');
            const rewardVideo = document.getElementById('reward-video');

            function showRewardModal() {
                rewardMessageContainer.classList.remove('hidden');
                rewardVideoContainer.classList.add('hidden');
                if (rewardVideo) {
                     rewardVideo.pause();
                     rewardVideo.currentTime = 0;
                 }
                 if(rewardModal) rewardModal.classList.add('active');
            }

            function hideRewardModal() {
                 if(rewardModal) rewardModal.classList.remove('active');
                 if(rewardVideo) rewardVideo.pause();
            }

            if (closeModalButton) closeModalButton.addEventListener('click', hideRewardModal);
            if (rewardModal) rewardModal.addEventListener('click', (event) => { if (event.target === rewardModal) hideRewardModal(); });
            if (rewardButton) rewardButton.addEventListener('click', () => {
                rewardMessageContainer.classList.add('hidden');
                rewardVideoContainer.classList.remove('hidden');
                 if(rewardVideo) rewardVideo.play().catch(error => console.error("Error al reproducir video:", error));
            });

            // --- L√ìGICA PARA EL DESAF√çO DE VIRTUDES ---
            const allChallenges = [
                // Originales
                {
                    scenario: "Est√°s jugando Minecraft y un creeper destruye la casa que te tom√≥ horas construir. Sientes ganas de lanzar el control.",
                    correctVirtue: "templanza",
                    feedback: {
                        sabiduria: "La sabidur√≠a te dir√≠a que es solo un juego, pero la Templanza es el poder espec√≠fico para *controlar* tu reacci√≥n de enojo en el momento.",
                        coraje: "No se necesita coraje aqu√≠, ya que no hay peligro. Lo que se necesita es calma.",
                        justicia: "El creeper no fue 'injusto', ¬°solo hizo lo que hacen los creepers! El poder que necesitas es el autocontrol.",
                        templanza: "¬°Correcto! La Templanza (Autocontrol) es el superpoder que usas para respirar hondo, no lanzar el control y recordar que puedes reconstruirlo."
                    }
                },
                {
                    scenario: "Tus amigos te invitan a jugar f√∫tbol, pero tienes un examen importante ma√±ana y tu abuelo Paco te aconsej√≥ estudiar.",
                    correctVirtue: "sabiduria",
                    feedback: {
                        sabiduria: "¬°Exacto! La Sabidur√≠a es el poder de ver el futuro (el examen de ma√±ana) y tomar la decisi√≥n inteligente, aunque no sea la m√°s divertida ahora.",
                        coraje: "Podr√≠a necesitarse un poco de coraje para decir 'no' a tus amigos, pero la virtud principal que usas para *decidir* es la sabidur√≠a.",
                        justicia: "No es una cuesti√≥n de justicia. Es una decisi√≥n sobre tus prioridades.",
                        templanza: "La templanza te ayudar√≠a a *no* jugar todo el d√≠a, pero la Sabidur√≠a es la que te dice *por qu√©* no deber√≠as hacerlo."
                    }
                },
                {
                    scenario: "Est√°s en el Nintendo Switch y tu hermana Elisa te exige que se lo prestes *ya mismo*. Tu primer instinto es decirle que se vaya.",
                    correctVirtue: "justicia",
                    feedback: {
                        sabiduria: "La sabidur√≠a te ayudar√≠a a planear una soluci√≥n, pero la Justicia es el poder que te recuerda *considerar* los sentimientos y derechos de Elisa.",
                        coraje: "No se requiere coraje en esta situaci√≥n.",
                        justicia: "¬°S√≠! La Justicia es el poder de ser justo con los dem√°s. Te hace preguntar: '¬øEs justo que yo juegue todo el tiempo? ¬øHicimos un trato?'. Te ayuda a encontrar una soluci√≥n justa para ambos.",
                        templanza: "Necesitas Templanza para *no* gritarle, pero la Justicia es la que te gu√≠a a *c√≥mo* actuar con ella de forma correcta."
                    }
                },
                {
                    scenario: "Tu entrenador de f√∫tbol te pide que intentes una nueva posici√≥n que te da miedo porque no sabes jugarla bien.",
                    correctVirtue: "coraje",
                    feedback: {
                        sabiduria: "La sabidur√≠a es saber que es bueno aprender cosas nuevas, pero el poder que necesitas para *superar el miedo* es el coraje.",
                        coraje: "¬°Correcto! El Coraje no es no tener miedo. Es tener miedo (a fallar, a verte mal) pero hacerlo de todos modos por un bien mayor (ayudar al equipo, aprender).",
                        justicia: "Esto no es sobre justicia, es sobre enfrentar un desaf√≠o personal.",
                        templanza: "La templanza te ayudar√≠a a no frustrarte si fallas, pero el Coraje es lo que te hace intentarlo en primer lugar."
                    }
                },
                {
                    scenario: "Tu mam√° (Jari) y tu abuela (Estela) te piden ayuda con las bolsas del s√∫per. Est√°s a punto de ganar una carrera de Sonic.",
                    correctVirtue: "justicia",
                    feedback: {
                        sabiduria: "La sabidur√≠a te dir√≠a que la familia es importante, pero la Justicia es el poder de la 'responsabilidad' y de hacer lo correcto por tu familia.",
                        coraje: "No requiere coraje, solo requiere dejar algo divertido por algo que se debe hacer.",
                        justicia: "¬°Perfecto! La Justicia tambi√©n significa ser un buen miembro de tu familia y comunidad. Pausar el juego para ayudar a Jari y Estela es la acci√≥n 'justa' y correcta.",
                        templanza: "Necesitas templanza para *no* quejarte, pero la Justicia es la que te dice *por qu√©* debes ir a ayudar."
                    }
                },
                 // Nuevos Desaf√≠os (50+) - ¬°Ampliados!
                {
                    scenario: "Un compa√±ero se burla de tus tenis nuevos en la escuela. Te sientes avergonzado y enojado.",
                    correctVirtue: "coraje",
                    feedback: {
                        sabiduria: "La sabidur√≠a te dice que su opini√≥n no define el valor de tus tenis ni el tuyo, pero el Coraje te da la fuerza para no dejar que te afecte.",
                        coraje: "¬°S√≠! El Coraje es ignorar la burla o responder con calma, sabiendo que t√∫ vales m√°s que una opini√≥n ajena. Es no dejar que el miedo a la cr√≠tica te domine.",
                        justicia: "Aunque la burla es injusta, la virtud principal aqu√≠ es manejar tu propia reacci√≥n interna con fortaleza.",
                        templanza: "La Templanza ayuda a no reaccionar exageradamente, pero el Coraje es la fortaleza interior para no sentirte mal por la burla."
                    }
                },
                {
                    scenario: "Tienes mucha tarea, pero tus amigos te est√°n esperando online para jugar Minecraft.",
                    correctVirtue: "templanza",
                    feedback: {
                        sabiduria: "La Sabidur√≠a te dice que la tarea es importante, pero la Templanza es el superpoder del autocontrol para *hacer* primero lo que debes.",
                        coraje: "No se necesita coraje, sino disciplina.",
                        justicia: "Es una cuesti√≥n de responsabilidad personal, m√°s que de justicia hacia otros.",
                        templanza: "¬°Exacto! Templanza es resistir la tentaci√≥n de jugar ahora y tener la disciplina para terminar tus deberes primero. ¬°El juego puede esperar!"
                    }
                },
                {
                    scenario: "En nataci√≥n, ves que un compa√±ero tiene dificultades para aprender una brazada nueva y otros se r√≠en.",
                    correctVirtue: "justicia",
                    feedback: {
                        sabiduria: "La sabidur√≠a te dir√≠a que todos aprenden a ritmos diferentes, pero la Justicia te impulsa a actuar correctamente.",
                        coraje: "Podr√≠as necesitar coraje para defenderlo, pero la motivaci√≥n principal viene de la Justicia.",
                        justicia: "¬°Correcto! La Justicia es defender al que lo necesita, no participar en la burla y, si te animas, ofrecerle ayuda o √°nimo. Es tratar a los dem√°s con respeto.",
                        templanza: "La templanza ayuda a no re√≠rte t√∫, pero la Justicia te pide ir m√°s all√° y ser solidario."
                    }
                },
                {
                    scenario: "Tu abuela Estela te cuenta la misma historia por d√©cima vez. Te aburres.",
                    correctVirtue: "templanza",
                    feedback: {
                        sabiduria: "La sabidur√≠a es entender que ella disfruta cont√°ndola, pero la Templanza es el poder de la paciencia.",
                        coraje: "No se necesita coraje aqu√≠.",
                        justicia: "Podr√≠a argumentarse que es 'justo' escucharla, pero la virtud clave es el autocontrol de tu aburrimiento.",
                        templanza: "¬°Exacto! Templanza es tener la paciencia para escucharla con atenci√≥n y amabilidad, aunque ya te sepas la historia. Es controlar tu impaciencia."
                    }
                },
                 {
                    scenario: "En un partido de f√∫tbol, el √°rbitro marca una falta en tu contra que claramente no cometiste.",
                    correctVirtue: "templanza",
                    feedback: {
                        sabiduria: "La sabidur√≠a te dice que discutir no cambiar√° la decisi√≥n, pero la Templanza controla tu reacci√≥n.",
                        coraje: "Se necesita coraje para aceptar una decisi√≥n injusta sin explotar, pero la Templanza es el autocontrol directo.",
                        justicia: "La situaci√≥n es injusta, pero tu reacci√≥n debe ser controlada. La virtud principal aqu√≠ es la Templanza.",
                        templanza: "¬°Correcto! Templanza es controlar tu frustraci√≥n, no gritarle al √°rbitro y seguir jugando concentrado. Aceptar lo que no puedes cambiar (la decisi√≥n)."
                    }
                },
                {
                    scenario: "Te enteras de que un amigo habl√≥ mal de ti a tus espaldas.",
                    correctVirtue: "sabiduria",
                    feedback: {
                        sabiduria: "¬°S√≠! La Sabidur√≠a es detenerte a pensar antes de reaccionar. ¬øEs verdad? ¬øVale la pena confrontarlo? ¬øC√≥mo hacerlo de forma constructiva? Pensar antes de actuar.",
                        coraje: "Podr√≠as necesitar Coraje para hablar con √©l, pero primero necesitas Sabidur√≠a para decidir *si* debes hacerlo y *c√≥mo*.",
                        justicia: "Lo que hizo no fue justo, pero tu primera virtud a usar es la Sabidur√≠a para analizar la situaci√≥n.",
                        templanza: "Necesitas Templanza para no explotar, pero la gu√≠a principal viene de la Sabidur√≠a."
                    }
                },
                 {
                    scenario: "Quieres comprar el nuevo juego de Sonic, pero sabes que debes ahorrar para el regalo de cumplea√±os de tu mam√° Jari.",
                    correctVirtue: "templanza",
                    feedback: {
                        sabiduria: "La sabidur√≠a te dice que el regalo es importante, pero la Templanza es el autocontrol para *no* gastar el dinero ahora.",
                        coraje: "No se requiere coraje, sino disciplina financiera.",
                        justicia: "Es un acto de cari√±o hacia tu mam√°, relacionado con la Justicia (ser buen hijo), pero la virtud directa es el autocontrol.",
                        templanza: "¬°Exacto! Templanza es resistir el deseo inmediato del juego por un bien mayor a futuro (el regalo). Es autocontrol sobre tus impulsos de compra."
                    }
                },
                {
                    scenario: "Tu hermana Elisa rompe accidentalmente algo tuyo que te gustaba mucho.",
                    correctVirtue: "templanza",
                    feedback: {
                        sabiduria: "La sabidur√≠a te ayuda a entender que fue un accidente, pero la Templanza gestiona tu enojo.",
                        coraje: "No se necesita coraje aqu√≠.",
                        justicia: "Podr√≠as pedir que lo reponga si es justo, pero la primera reacci√≥n a controlar es tu enojo, usando Templanza.",
                        templanza: "¬°Correcto! Es normal sentir enojo, pero la Templanza te ayuda a respirar, no gritarle, y recordar que los accidentes pasan. Es controlar tu reacci√≥n inicial."
                    }
                },
                {
                    scenario: "Debes presentar un trabajo oral en clase y te da mucho p√°nico hablar en p√∫blico.",
                    correctVirtue: "coraje",
                    feedback: {
                        sabiduria: "La sabidur√≠a te dice que prepararte bien te ayudar√°, pero el poder para *enfrentar* el miedo es el Coraje.",
                        coraje: "¬°S√≠! El Coraje es hacer la presentaci√≥n aunque sientas miedo o nervios. Es actuar a pesar del p√°nico.",
                        justicia: "No aplica directamente aqu√≠.",
                        templanza: "La templanza te ayuda a mantener la calma *durante* la presentaci√≥n, pero el Coraje es lo que te hace subir ah√≠."
                    }
                },
                {
                    scenario: "Tu equipo de f√∫tbol pierde un partido importante por un error tuyo.",
                    correctVirtue: "coraje",
                    feedback: {
                        sabiduria: "La sabidur√≠a te dice que todos cometen errores y que puedes aprender de esto, pero el Coraje te ayuda a afrontarlo.",
                        coraje: "¬°Exacto! Coraje es aceptar tu error, no esconderte ni culpar a otros, y seguir entrenando para mejorar. Es la fortaleza para enfrentar la decepci√≥n.",
                        justicia: "No es sobre justicia, es sobre asumir responsabilidad.",
                        templanza: "La templanza te ayuda a no hundirte en la tristeza, pero el Coraje es la fuerza para levantarte despu√©s del error."
                    }
                },
                 {
                    scenario: "Est√°s muy cansado despu√©s de nataci√≥n y no quieres hacer la tarea de historia.",
                    correctVirtue: "templanza",
                     feedback: { sabiduria:"La Sabidur√≠a sabe que es mejor hacerla ahora.", coraje:"No se requiere coraje.", justicia:"Es justo contigo mismo cumplir.", templanza:"¬°S√≠! Templanza es la disciplina para hacer lo que debes, aunque est√©s cansado." }
                },
                {
                    scenario: "Un amigo te presiona para saltarte la clase de nataci√≥n.",
                    correctVirtue: "coraje",
                     feedback: { sabiduria:"La Sabidur√≠a te dice que no debes faltar.", coraje:"¬°Correcto! Coraje es decir 'no' a la presi√≥n de grupo y mantenerte firme en tus responsabilidades.", justicia:"Faltar podr√≠a ser injusto con tu compromiso.", templanza:"..." }
                },
                {
                    scenario: "Ves a tu hermana Elisa triste porque no la invitaron a una fiesta.",
                    correctVirtue: "justicia",
                     feedback: { sabiduria:"La Sabidur√≠a te ayuda a entender sus sentimientos.", coraje:"...", justicia:"¬°S√≠! Justicia (en el sentido amplio de bondad y empat√≠a) es consolarla y mostrarle tu apoyo.", templanza:"..." }
                },
                 {
                    scenario: "Quieres jugar Minecraft toda la tarde, pero sabes que prometiste ayudar a tu abuelo Paco con el jard√≠n.",
                    correctVirtue: "justicia",
                     feedback: { sabiduria:"...", coraje:"...", justicia:"¬°Exacto! Justicia es cumplir tus promesas y responsabilidades, especialmente con tu familia.", templanza:"Necesitas Templanza para dejar el juego." }
                },
                {
                    scenario: "Te das cuenta de que accidentalmente incluiste informaci√≥n falsa en un trabajo escolar.",
                    correctVirtue: "justicia",
                     feedback: { sabiduria:"La Sabidur√≠a te dice que debes corregirlo.", coraje:"Necesitas Coraje para admitir el error.", justicia:"¬°Correcto! Justicia es ser honesto acad√©micamente y corregir tu error ante el profesor.", templanza:"..." }
                },
                 {
                    scenario: "Te cuesta levantarte temprano para ir a entrenar f√∫tbol.",
                    correctVirtue: "templanza",
                     feedback: { sabiduria:"Sabes que entrenar es bueno.", coraje:"Necesitas Coraje para enfrentar la pereza.", justicia:"...", templanza:"¬°S√≠! Templanza es la disciplina y el autocontrol para vencer la pereza y levantarte." }
                },
                {
                    scenario: "Tu mam√° Jari te pide tu opini√≥n sobre un platillo nuevo que cocin√≥ y no te gust√≥ nada.",
                    correctVirtue: "sabiduria",
                     feedback: { sabiduria:"¬°Exacto! Sabidur√≠a es encontrar la forma de ser honesto sin herir sus sentimientos. Buscar palabras amables pero sinceras.", coraje:"...", justicia:"Ser brutalmente honesto podr√≠a ser injusto.", templanza:"Necesitas Templanza para no hacer una mueca." }
                },
                 {
                    scenario: "Pierdes tu partida guardada de Sonic por un error del juego.",
                    correctVirtue: "templanza",
                     feedback: { sabiduria:"La Sabidur√≠a recuerda que es solo un juego.", coraje:"...", justicia:"...", templanza:"¬°Correcto! Templanza es aceptar la p√©rdida (que no controlas) sin frustrarte excesivamente." }
                },
                 {
                    scenario: "Un compa√±ero nuevo llega a clase y nadie le habla.",
                    correctVirtue: "justicia",
                     feedback: { sabiduria:"...", coraje:"Necesitas Coraje para acercarte.", justicia:"¬°S√≠! Justicia es ser amable e inclusivo, darle la bienvenida al nuevo compa√±ero.", templanza:"..." }
                },
                {
                   scenario: "Tienes muchas ganas de comerte toda la bolsa de papitas.",
                   correctVirtue: "templanza",
                   feedback: { sabiduria:"La Sabidur√≠a sabe que no es saludable.", coraje:"...", justicia:"...", templanza:"¬°Exacto! Templanza es moderaci√≥n, comer solo una porci√≥n razonable."}
                },
                {
                    scenario: "Te equivocas al dar un pase en f√∫tbol y tu entrenador te rega√±a fuerte.",
                    correctVirtue: "coraje",
                    feedback: { sabiduria:"La Sabidur√≠a es aprender del error.", coraje:"¬°S√≠! Coraje es aceptar la cr√≠tica (aunque sea dura), no desanimarte y seguir esforz√°ndote.", justicia:"...", templanza:"Necesitas Templanza para no responder mal."}
                },
                {
                    scenario: "Tu abuela Estela necesita que le leas las letras peque√±as de una etiqueta.",
                    correctVirtue: "justicia",
                    feedback: { sabiduria:"...", coraje:"...", justicia:"¬°Correcto! Justicia es ayudar a tu familia con paciencia y amabilidad.", templanza:"Necesitas Templanza si te interrumpe." }
                },
                 {
                    scenario: "Quieres comprar algo online pero no est√°s seguro si la p√°gina es confiable.",
                    correctVirtue: "sabiduria",
                    feedback: { sabiduria:"¬°S√≠! Sabidur√≠a es investigar, leer rese√±as y pensar cuidadosamente antes de dar tu informaci√≥n o dinero.", coraje:"...", justicia:"...", templanza:"..."}
                },
                 {
                    scenario: "Te caes practicando un movimiento de karate delante de todos.",
                    correctVirtue: "coraje",
                    feedback: { sabiduria:"...", coraje:"¬°Exacto! Coraje es levantarte, sacudirte el polvo (y la verg√ºenza) y seguir practicando.", justicia:"...", templanza:"..."}
                },
                {
                   scenario: "Dividen equipos en clase y te toca con gente que no te cae bien.",
                   correctVirtue: "justicia",
                   feedback: { sabiduria:"La Sabidur√≠a es buscar la forma de trabajar juntos.", coraje:"...", justicia:"¬°S√≠! Justicia es tratar a todos con respeto y colaborar para hacer el trabajo, sin importar tus preferencias.", templanza:"Necesitas Templanza para controlar tu fastidio."}
                },
                 {
                    scenario: "Tu conexi√≥n a internet va muy lenta justo cuando ibas a empezar una partida online.",
                    correctVirtue: "templanza",
                    feedback: { sabiduria:"...", coraje:"...", justicia:"...", templanza:"¬°Correcto! Templanza es aceptar la situaci√≥n (que no controlas) con paciencia y buscar otra actividad mientras se arregla."}
                },
                {
                   scenario: "Prometiste a tu abuelo Paco que lo llamar√≠as, pero se te olvid√≥.",
                   correctVirtue: "justicia",
                   feedback: { sabiduria:"La Sabidur√≠a es aprender a organizarte mejor.", coraje:"Necesitas Coraje para admitir tu olvido.", justicia:"¬°S√≠! Justicia es reconocer tu error, disculparte sinceramente y llamarlo ahora.", templanza:"..."}
                },
                 {
                    scenario: "Ves un documental sobre la contaminaci√≥n y te sientes triste y preocupado por el planeta.",
                    correctVirtue: "sabiduria",
                    feedback: { sabiduria:"¬°S√≠! Sabidur√≠a es canalizar esa preocupaci√≥n en acciones concretas que S√ç puedes controlar (reciclar, ahorrar agua, etc.), en lugar de solo angustiarte.", coraje:"...", justicia:"Actuar es Justicia.", templanza:"..."}
                },
                 {
                   scenario: "Se cancela el viaje a la playa por mal tiempo.",
                   correctVirtue: "templanza",
                   feedback: { sabiduria:"...", coraje:"...", justicia:"...", templanza:"¬°Correcto! Templanza es aceptar la decepci√≥n y el cambio de planes sin enfadarte demasiado. Buscar un plan B."}
                },
                 {
                   scenario: "Tu amigo est√° triste porque su mascota est√° enferma.",
                   correctVirtue: "justicia",
                   feedback: { sabiduria:"La Sabidur√≠a te ayuda a encontrar las palabras adecuadas.", coraje:"...", justicia:"¬°S√≠! Justicia (empat√≠a) es escuchar a tu amigo, ofrecerle consuelo y apoyo.", templanza:"..."}
                },
                 {
                   scenario: "Tienes la opci√≥n de empezar tu tarea ahora o dejarla para m√°s tarde.",
                   correctVirtue: "sabiduria",
                   feedback: { sabiduria:"¬°Exacto! Sabidur√≠a es reconocer que hacerla ahora te evitar√° estr√©s despu√©s.", coraje:"...", justicia:"...", templanza:"Necesitas Templanza para ponerte a hacerla."}
                },
                 {
                   scenario: "Durante un juego, accidentalmente empujas a un compa√±ero.",
                   correctVirtue: "justicia",
                   feedback: { sabiduria:"...", coraje:"...", justicia:"¬°S√≠! Justicia es disculparte sinceramente de inmediato.", templanza:"..."}
                },
                 {
                   scenario: "Sientes envidia porque a tu amigo le compraron el √∫ltimo modelo de celular.",
                   correctVirtue: "templanza",
                   feedback: { sabiduria:"La Sabidur√≠a recuerda que las cosas materiales no dan la felicidad.", coraje:"...", justicia:"...", templanza:"¬°Correcto! Templanza es controlar ese sentimiento de envidia y estar feliz por tu amigo (o al menos no resentido)."}
                },
                 {
                   scenario: "Debes decidir si gastar tu domingo en el parque con tu familia o jugando videojuegos solo.",
                   correctVirtue: "sabiduria",
                   feedback: { sabiduria:"¬°S√≠! Sabidur√≠a es sopesar las opciones, valorar el tiempo en familia y tomar una decisi√≥n equilibrada (quiz√°s un poco de ambos).", coraje:"...", justicia:"Pasar tiempo con la familia es parte de la Justicia.", templanza:"Necesitas Templanza para limitar el juego."}
                },
                 {
                   scenario: "Se burlan de ti por c√≥mo bailas en una fiesta.",
                   correctVirtue: "coraje",
                   feedback: { sabiduria:"...", coraje:"¬°Exacto! Coraje es seguir divirti√©ndote sin importar lo que digan los dem√°s, o ignorarlos con confianza.", justicia:"...", templanza:"..."}
                },
                 {
                   scenario: "Te ofrecen probar un cigarro electr√≥nico.",
                   correctVirtue: "sabiduria",
                   feedback: { sabiduria:"¬°S√≠! Sabidur√≠a es conocer los riesgos para tu salud y tomar la decisi√≥n correcta para ti.", coraje:"Necesitas Coraje para decir 'no'.", justicia:"...", templanza:"..."}
                },
                 {
                   scenario: "Tu hermana Elisa usa tus cosas sin permiso y te molesta mucho.",
                   correctVirtue: "sabiduria",
                   feedback: { sabiduria:"¬°Correcto! Sabidur√≠a es hablar con ella con calma (usando Templanza) para establecer l√≠mites claros, en lugar de solo gritar.", coraje:"...", justicia:"Establecer l√≠mites es justo.", templanza:"Necesitas Templanza para hablar sin gritar."}
                },
                 {
                   scenario: "Est√°s aburrido y no sabes qu√© hacer.",
                   correctVirtue: "sabiduria",
                   feedback: { sabiduria:"¬°S√≠! Sabidur√≠a es buscar actividades productivas o creativas (leer, dibujar, aprender algo nuevo) en lugar de solo quejarte.", coraje:"...", justicia:"...", templanza:"..."}
                },

                // ... A√±adir m√°s hasta superar 50 ...

            ];

            let currentChallengeIndex = 0; // Se declara aqu√≠, fuera de la funci√≥n de historias
            
            // B. Obtener elementos del DOM
            const scenarioTextEl = document.getElementById('scenario-text');
            const virtueButtonsEl = document.getElementById('virtue-buttons');
            const virtueFeedbackEl = document.getElementById('virtue-feedback');
            const nextChallengeButtonEl = document.getElementById('next-challenge-button');
            const allVirtueButtons = virtueButtonsEl.querySelectorAll('.virtue-button');
            
             // C. Funci√≥n para obtener el nombre legible de la virtud
             function getVirtueName(virtueKey) {
                 switch (virtueKey) {
                     case 'sabiduria': return 'Sabidur√≠a';
                     case 'coraje': return 'Coraje';
                     case 'justicia': return 'Justicia';
                     case 'templanza': return 'Templanza';
                     default: return '';
                 }
             }

            // D. Funci√≥n para cargar un desaf√≠o
            function loadChallenge(index) {
                 if (!allChallenges || allChallenges.length === 0) {
                     console.error("La lista de desaf√≠os est√° vac√≠a o no definida.");
                     return; 
                 }
                 // Asegurarse de que el √≠ndice es v√°lido y cicla
                 currentChallengeIndex = index % allChallenges.length; 
                 const challenge = allChallenges[currentChallengeIndex]; // Usar el √≠ndice ciclado
                 
                if (!challenge) {
                    console.error(`No se encontr√≥ desaf√≠o en el √≠ndice ${currentChallengeIndex}`);
                    return;
                }

                if (scenarioTextEl) {
                     scenarioTextEl.textContent = challenge.scenario;
                } else {
                     console.error("Elemento 'scenario-text' no encontrado.");
                 }
                
                // Resetear botones y feedback
                 if (virtueFeedbackEl) virtueFeedbackEl.classList.add('hidden');
                 if (nextChallengeButtonEl) nextChallengeButtonEl.classList.add('hidden');
                 
                allVirtueButtons.forEach(btn => {
                    btn.disabled = false;
                    btn.classList.remove('opacity-50', 'cursor-not-allowed');
                });
            }

            // E. Funci√≥n para manejar la elecci√≥n (MODIFICADA para feedback de error)
            function handleVirtueChoice(e) {
                const chosenVirtue = e.currentTarget.getAttribute('data-virtue');
                const challenge = allChallenges[currentChallengeIndex];

                 if (!challenge || !challenge.feedback) {
                    console.error("Desaf√≠o actual o feedback no definido.");
                    return; // Salir si no hay desaf√≠o o feedback
                 }

                const feedbackText = challenge.feedback[chosenVirtue]; // El texto explicativo
                const isCorrect = (chosenVirtue === challenge.correctVirtue);
                let finalFeedback = ""; // Mensaje final a mostrar

                // Mostrar feedback
                 if (virtueFeedbackEl) {
                     if (isCorrect) {
                         finalFeedback = feedbackText || "¬°Respuesta Correcta!"; // Mensaje por defecto si falta
                         virtueFeedbackEl.className = "min-h-[100px] p-4 rounded-lg text-center text-lg font-medium bg-green-100 text-green-800 border border-green-300";
                         // ¬°NUEVO! Disparar confeti si la respuesta es correcta
                          if (typeof confetti === 'function') {
                             confetti({
                                 particleCount: 100,
                                 spread: 70,
                                 origin: { y: 0.6 }
                             });
                         }
                     } else {
                         // ¬°NUEVO! Mensaje de error indicando la correcta
                         const correctVirtueName = getVirtueName(challenge.correctVirtue);
                         finalFeedback = `¬°Error! La virtud correcta aqu√≠ ser√≠a ${correctVirtueName}. ${feedbackText || "Intenta pensar por qu√©."}`; // A√±adir explicaci√≥n
                         virtueFeedbackEl.className = "min-h-[100px] p-4 rounded-lg text-center text-lg font-medium bg-red-100 text-red-800 border border-red-300"; // Cambiado a rojo para error
                     }
                     virtueFeedbackEl.textContent = finalFeedback;
                     virtueFeedbackEl.classList.remove('hidden');

                 } else {
                     console.error("Elemento 'virtue-feedback' no encontrado.");
                 }

                // Desactivar botones y mostrar "Siguiente"
                allVirtueButtons.forEach(btn => {
                    btn.disabled = true;
                    btn.classList.add('opacity-50', 'cursor-not-allowed');
                });
                 if (nextChallengeButtonEl) nextChallengeButtonEl.classList.remove('hidden');
            }

            // F. Asignar Event Listeners
            allVirtueButtons.forEach(btn => {
                btn.addEventListener('click', handleVirtueChoice);
            });

             if (nextChallengeButtonEl) {
                nextChallengeButtonEl.addEventListener('click', () => {
                    // Simplemente incrementa, loadChallenge se encarga de ciclar
                    loadChallenge(currentChallengeIndex + 1); 
                });
            }


            // --- L√ìGICA PARA EL VISOR DE HISTORIAS ---

            // A. Base de datos de todas las historias
            const allStories = [/* ... (las 20 historias como antes) ... */
                // Historias Cl√°sicas
                { id: "epicteto", title: "Epicteto, el Esclavo Sabio", colorScheme: "cyan", paragraphs: ["..."], lesson: "..." },
                { id: "marco_aurelio", title: "El Emperador que Escrib√≠a su Diario", colorScheme: "amber", paragraphs: ["..."], lesson: "..." },
                { id: "seneca", title: "S√©neca y el Emperador Loco", colorScheme: "red", paragraphs: ["..."], lesson: "..." },
                { id: "zenon", title: "Zen√≥n y el Naufragio", colorScheme: "blue", paragraphs: ["..."], lesson: "..." },
                { id: "cato", title: "Cato, el Incorruptible", colorScheme: "gray", paragraphs: ["..."], lesson: "..." },
                { id: "eleccion_hercules", title: "La Elecci√≥n de H√©rcules", colorScheme: "green", paragraphs: ["..."], lesson: "..." },
                { id: "socrates", title: "S√≥crates y la Cicuta", colorScheme: "purple", paragraphs: ["..."], lesson: "..." },
                { id: "bambu", title: "La Paciencia del Bamb√∫ Japon√©s", colorScheme: "green", paragraphs: ["..."], lesson: "..." },
                { id: "diogenes", title: "Di√≥genes y Alejandro Magno", colorScheme: "yellow", paragraphs: ["..."], lesson: "..." },
                { id: "granjero_roca", title: "El Granjero y la Roca", colorScheme: "stone", paragraphs: ["..."], lesson: "..." },
                { id: "musonio", title: "Musonio Rufo y el Exilio", colorScheme: "blue", paragraphs: ["..."], lesson: "..." },
                { id: "aguila", title: "El √Åguila que Renace", colorScheme: "orange", paragraphs: ["..."], lesson: "..." },
                { id: "escultor", title: "El Escultor Estoico", colorScheme: "gray", paragraphs: ["..."], lesson: "..." },
                { id: "horacio", title: "Horacio en el Puente", colorScheme: "red", paragraphs: ["..."], lesson: "..." },
                { id: "crisipo", title: "Crisipo, el Corredor", colorScheme: "cyan", paragraphs: ["..."], lesson: "..." },
                // Historias de El√≠as
                { id: "elias_futbol", title: "El√≠as y el Penal Fallado", colorScheme: "green", paragraphs: ["..."], lesson: "..." },
                { id: "elias_minecraft", title: "El√≠as y el Creeper Traicionero", colorScheme: "emerald", paragraphs: ["..."], lesson: "..." },
                { id: "elias_natacion", title: "El√≠as y el Agua Fr√≠a", colorScheme: "sky", paragraphs: ["..."], lesson: "..." },
                { id: "elias_switch", title: "El√≠as, Elisa y el Jefe de Sonic", colorScheme: "blue", paragraphs: ["..."], lesson: "..." },
                { id: "elias_karate", title: "El√≠as y la Disciplina de la Abuela Estela", colorScheme: "purple", paragraphs: ["..."], lesson: "..." }
            ];

            // B. Obtener elementos del DOM (Visor de Historias)
            const storySelector = document.getElementById('story-selector');
            const storyContentWrapper = document.getElementById('story-content-wrapper');

            // C. Funci√≥n para poblar el selector de historias
            function populateStorySelector() {
                if (!storySelector) return;
                storySelector.innerHTML = '';
                allStories.forEach(story => {
                    const option = document.createElement('option');
                    option.value = story.id;
                    option.textContent = story.title;
                    storySelector.appendChild(option);
                });
            }

            // D. Funci√≥n para mostrar una historia espec√≠fica
            function displayStory(storyId) {
                if (!storyContentWrapper) return;
                const story = allStories.find(s => s.id === storyId);
                if (!story) return;
                let contentHTML = `<h3 class="text-2xl font-bold text-${story.colorScheme}-700 mb-4">${story.title}</h3>`;
                story.paragraphs.forEach(p => { contentHTML += `<p class="mb-4 text-lg leading-relaxed">${p}</p>`; });
                contentHTML += `<div class="mt-auto bg-${story.colorScheme}-100 border-l-4 border-${story.colorScheme}-500 p-4 rounded-r-lg"><strong class="text-${story.colorScheme}-800">Lecci√≥n:</strong> "${story.lesson}"</div>`;
                storyContentWrapper.innerHTML = contentHTML;
            }

            // E. Event Listener para el selector
            if (storySelector) {
                storySelector.addEventListener('change', (e) => displayStory(e.target.value));
            }

            // F. Carga inicial
            function initializeStoryViewer() {
                populateStorySelector();
                const randomIndex = Math.floor(Math.random() * allStories.length);
                const randomStory = allStories[randomIndex];
                if (storySelector) storySelector.value = randomStory.id;
                displayStory(randomStory.id);
            }

            // --- L√ìGICA PARA EL FOOTER ALEATORIO ---
            function setRandomFooterQuote() {
                const intros = ["¬°Sigue as√≠, El√≠as!", "¬°Un pensamiento de h√©roe para ti, El√≠as!", "¬°Fuerza, El√≠as!", "¬°T√∫ puedes, El√≠as!", "¬°Palabras sabias para ti, El√≠as!"];
                const quotes = ["El obst√°culo es el camino. ¬°Cada desaf√≠o te hace m√°s fuerte!", "Ser estoico significa ser como un roble: firme ante la tormenta, pero flexible para no romperse.", "La felicidad no est√° en lo que pasa, sino en c√≥mo eliges ver lo que pasa.", "El verdadero superpoder es el autocontrol. ¬°Domina tus reacciones!", "Conc√©ntrate en tu esfuerzo, no en el resultado. ¬°Ah√≠ est√° tu verdadero control!", "Hoy es una nueva oportunidad para practicar tu coraje y tu paciencia.", "No te preocupes por lo que no puedes cambiar. Invierte tu energ√≠a en lo que s√≠ puedes hacer.", "La calma es tu escudo. √ösala cuando sientas enojo o miedo.", "Cada vez que eliges ser amable o justo, ganas una batalla interior.", "Tu mente es tu fortaleza. ¬°T√∫ decides qui√©n entra y qui√©n no!"];
                const randomIntro = intros[Math.floor(Math.random() * intros.length)];
                const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
                const footerQuoteElement = document.getElementById('footer-quote');
                if (footerQuoteElement) footerQuoteElement.innerHTML = `<strong class="block mb-2">${randomIntro}</strong> "${randomQuote}"`;
            }

            // --- ARRANQUE INICIAL ---
            populateWorriesList();
            setupDraggables();
            shuffleArray(allChallenges);
            loadChallenge(0);
            initializeStoryViewer();
            setRandomFooterQuote();
        });
    </script>

</body>
</html>

